# 防火墙入门（一）
## 1.状态
    ESTABLISHED 表示该信息包属于已建立的连接，该连接一直用于发送和接收信息包并且完全有效；
    INVALID  表示该信息包与任何已知的流或连接都不相关，它可能包含了错误的数据或头；
    NEW  表示该信息包已经或即将启动新的连接，或者它与尚未用于发送和接收信息包的连接相关联；
    RELATED  表示该信息包正在启动新连接，以及它与已建立的连接相关联的连接。

## 2.三表
    filter是默认表，包含真正的防火墙过滤规则。内建的规则链包括：INPUT、OUTPUT、FORWARD。
    nat表包含源、目的地址及端口转换实用的规则，内建规则链包括 PERROUTING、OUTPUT和POSTROUTING。
    mangle表包含用于设置特殊的数据包路由标志的规则。随后filter表中的规则会检查这些标志。内建的规则链包括：PEEROUTING、POSTRING、OUTPUT、INPUT、FORWARD。
## 3.五链
    INPUT链：当一个数据包由内核中的路由计算确定为本地的LINUX系统后，他会通过INPUT链的检查；
    OUTPUT链：保留给系统自身生成的数据包；
    FORWARD链：经过linux系统路由的数据包（即当iptables防火墙用于连接两个网络时，两个网络之间数据包必须流经该防火墙）
    PERROUTING链：用于修改目的地址(DNAT)
    POSTROUTING链：用于修改源地址（SNAT）

## 4.iptables语法
    iptables [-t 表名] <-A |I |D |R > 链名 [规则编号] [-i |o 网卡名称] [-p 协议类型] [-s 源IP地址 |源子网] [--sport 源端口号] [-d 目标IP地址 | 目标子网] [--dport 目标端口号] <-j 动作>

### 4.1定义默认策略
    作用：当数据包不符合链中任意一条规则时，iptables将根据该链预先定义好的默认策略来处理数据包
    格式： iptables [-t 表名] <-p> <链名> <动作>
    
### 4.2查看iptables规则
    格式： iptables [-t 表名] <-L> [链名]
### 4.3增加、插入、删除、替换
    -A 新增加一条规则，该规则将会增加到规则列表的最后一行，改参数不能使用规则编号
    -I 插入一条规则，原本该位置上的规则将会往后顺序移动，如果没有指定规则编号，则在第一条规则前插入
    -D 从规则列表中删除一条规则，可以输入要删除的完整规则，或者直接指定规则编号加以删除
    -R 替换某条规则，规则被替换并不会改变顺序，必须要指定被替换的规则编号
## 5.处理数据包动作
    1.ACCEPT：接收数据包
    2.DROP：丢弃数据包
    3.REDIRECT：将数据包重新转向到本机或另一台主机的某一个端口，通常实现透明的代理或对外开放内网的某些服务
    4.REJECT:拦截该数据封包，并发回封包通知对方。
    5.SNAT：源地址转换，即改变数据包的源地址。例如：将局域网的IP（10.0.0.1/24）转化为广域网的IP（203.93.236.141/24）,在NAT表的POSTROUTING链上进行该动作。
    6.DNAT:目的地址转换，即改变数据包的目标地址。
    7.MASQUERADE:IP伪装，即常说的NAT技术，MASQUERADE只能用于ADSL等拨号上网的IP伪装，也就是主机的IP是由ISP动态分配的，如果主机的IP地址是静态固定的，就要使用SNAT.
    8.LOG：日志功能，将符合规则的数据包的相关信息记录在日志中，以便管理员的分析和排错。
    
## 6清除规则
     iptables [-t] <-F | z>
     -F 删除指定表中所有规则
     -Z 将指定表中的数据包计数器和流量计数器归零
     